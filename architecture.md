
# Архитектура для обслуживания 1200 email-адресов аутрича

Цель: минимальная стоимость, высокая отказоустойчивость, стабильная работа SMTP.

---

## Общая идея

Используем:
- дешёвые домены → Namecheap / Porkbun
- дешёвые почтовые ящики → Zoho Mail + Mailgun Routing
- распределение нагрузки → ротация между серверами и доменами
- мониторинг → UptimeRobot + имейл-трекер + webhooks

На каждый домен — 1–3 почтовых адреса.  
На 1200 адресов достаточно 400–600 доменов.

---

## Компоненты

### **1. Email-провайдеры**
- **Zoho Mail (бесплатный/минимальный тариф)**  
  — высокая надёжность, дешёвые ящики  
- **Mailgun Routing**  
  — используется как SMTP-прокси  
  — дешёвая отправка и гибкие лимиты  
  — автоматический ретрай

### **2. SMTP-ротация**
Для каждого потока писем:

1. Берём доступные почтовые ящики.
2. Отправляем с них циклически.
3. Следим за rate limits:
   - 100–150 писем / день / адрес
   - 1 письмо в 30–60 секунд
4. Автоматически отключаем почтовые ящики с bounce rate > 10%.

---

## Мониторинг

1. **Проверка MX и DNS каждые 10 минут**
2. **Bounce tracking** через Mailgun Webhooks
3. **UptimeRobot** — доступность SMTP/IMAP
4. **Логи отправки + алерты в Telegram**

---

## Распределение нагрузки

- 1200 адресов → 4 группы по 300
- каждая группа на своём SMTP-пуле
- лимиты:
  - 300 писем / час на группу
  - пауза 30–45 сек между письмами
- геораспределение:
  - Mailgun US + EU regions

---

## Риски

| Риск | Как решаем |
|------|------------|
| Бан домена | автоматическая ротация, запасные домены |
| Снижение deliverability | прогрев доменов через Warmup |
| Превышение лимитов | throttling на backend |
| Пропуск bounce | Webhooks + алерты |

---

## Стоимость (примерно)

| Компонент | Цена |
|-----------|-------|
| Домен | 8–12$ / год |
| 400 доменов | ~3500$ / год |
| Mailgun | ~35–70$ / месяц |
| UptimeRobot | бесплатно |
| Zoho Mail | 1–2$ / адрес (при необходимости) |

**Итог: ~300–500$ / месяц за всю систему.**

---

## Итог

Получается дешёвая, масштабируемая и отказоустойчивая система, которую можно быстро расширять под новые направления аутрича.
